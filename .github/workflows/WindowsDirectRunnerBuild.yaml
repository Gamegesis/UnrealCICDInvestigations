name: Windows Direct Project Build
on: 
  workflow_dispatch:
    inputs:
      project_file:
        description: The uproject project file name without the extension
        type: string
        required: true

jobs:
  windows_direct_runner_build:
    runs-on: self-hosted
    steps:
      - name: Caching Unreal 
        id: UnrealEngine_Cache
        uses: actions/cache@v3
        with:
          path: Unreal
          key: "Unreal_Cache"
      - name: Display Cache Output
        run: echo '${{ toJSON(steps.UnrealEngine_Cache.outputs) }}'
      - name: Retrieve Engine
        uses: actions/checkout@v4
        with:
           lfs: true
           ref: release
           token: ${{ secrets.PAT_TOKEN }}
           repository: EpicGames/UnrealEngine
           path: Unreal
      - name: Build Unreal Engine
        run: |
           cd Unreal
           ls
           .\Setup.bat
           cd ..
           ls Unreal\Engine\Binaries\Win64\*.exe
      - name: build project
        run: |
          pwd
          ls
          echo ${{ inputs.project_file }}
        # Engine/Build/BatchFiles/RunUAT.sh BuildCookRun -utf8output -platform=Win64 -clientconfig=Shipping -serverconfig=Shipping -project=/project/${{ inputs.project_file }}.uproject -noP4 -nodebuginfo -allmaps -cook -build -stage -prereqs -pak -archive -archivedirectory=/project/Packaged

